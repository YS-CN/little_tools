setwd("E:\\zhangyan\\figure1")
library(plotrix)
pieplot <- function(r=0.2,total=4305181,Exon=1186517,Intron=2525812) {
    Genic <- Exon+Intron
    Intergenic <- total-Genic
    cols <- c(NO='white',Genic='#00a0e9',Intergenic='#da1c6f',Intron='#f8b62b',Exon='#009944')
    pie(1, radius=r, init.angle=90, col="white", border=NA, labels='')
    
    nn = floating.pie(0,0, c(Exon,Intron,Intergenic),radius=5*r,startpos=pi/2,col=cols[c("Exon", "Intron",'Intergenic')],border=NA)
    id = paste(c(round(Exon/total*100,2),round(Intron/total*100,2),round(Intergenic/total*100,2)),"%",sep="")
    pie.labels(0,0,nn,id,radius=4*r+0.005,minangle=0.2,explode=c(0.3,0.3,0.3,0.3),border=NA)

    floating.pie(0,0, c(Intron),radius=4*r,startpos=pi/2,col=cols[c("NO")],border=NA)
    floating.pie(0,0, c(Intron),radius=3*r,startpos=pi/2,col=cols[c("NO")],border=NA)
    
    nn = floating.pie(0, 0, c(Genic, Intergenic),radius=2*r,startpos=pi/2,col=cols[c("Genic", "Intergenic")],border=NA)
    id = paste(c(round(Genic/total*100,2),round(Intergenic/total*100,2)),"%",sep="")
    pie.labels(0,0,nn,id,radius=2*r+0.005,minangle=0.2,explode=c(0.05,0.05,0.05,0.05),border=NA)
    legend(5*r, 5*r, legend=sub("_", " ", names(cols)[-1]),fill=cols[-1], bty="n", cex=1.2)
}
#pieplot()
pdf("allrich-06.RNA.pdf",width=10)
pieplot(total=4305181,Exon=1186517,Intron=2525812)
dev.off()
pdf("allrich-23.RNA.pdf",width=10)
pieplot(total=36867156,Exon=11070866,Intron=19973065)
dev.off()
pdf("allrich-32.RNA.pdf",width=10)
pieplot(total=11703287,Exon=2806074,Intron=6187252)
dev.off()
pdf("allrich-10.RNA.pdf",width=10)
pieplot(total=38996549,Exon=6344343,Intron=28198451)
dev.off()

pdf("allrich-04.RNA.pdf",width=10)
pieplot(total=14177459,Exon=2555914,Intron=8435279)
dev.off()
pdf("allrich-22.RNA.pdf",width=10)
pieplot(total=21898879,Exon=4200719,Intron=11929824)
dev.off()
pdf("allrich-37.RNA.pdf",width=10)
pieplot(total=6238243,Exon=1277551,Intron=2713619)
dev.off()
pdf("allrich-29.RNA.pdf",width=10)
pieplot(total=60270553,Exon=12410757,Intron=42623352)
dev.off()
